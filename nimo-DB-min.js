(function(){function NimoDB(){if(this instanceof NimoDB==!1)return new NimoDB;var _this=this;this[NIMO_DB_ID.SYNC_KEY]=function(){for(var id,foo=new Function,config={cache:!0,typeSensitive:!0,accept:["array","object","number","string"]},i=0;arguments.length>i;i++){var ty=arguments[i]?typeof arguments[i]:null;"string"===ty||arguments[i]instanceof String?id=arguments[i]:"object"===ty?(arguments[i].__proto__=config,config=arguments[i],config.settled=!0):"function"===ty&&(foo=arguments[i])}id===SynID&&_console.error(`"${id}" is already taken for our prototype`),("string"!=typeof id&&id instanceof String==!1||!id.trim())&&(id=SynID),id=id.trim();var Env=setEnv(SynNAME,id),GCollector=Env.GC,db=Env.DB;if(db.obj)return db.obj;db.obj=new METHODS,db.Syncdata=db.Syncdata||[],db.config=db.config||config,db.data=db.data||new Items(!0),db.keys=db.keys||[],db.dataAsArray=db.dataAsArray||[],db.SyncResolving=db.SyncResolving||0,db.opening=db.opening||0,"cache"in db.config==!1&&(db.config.cache=!0);var obj=db.obj,p=function(exec,promise,parent,argument,foo){if(db.config.filter&&db.config.filter instanceof Function&&"function"==typeof db.config.filter){var filter=new db.config.filter(argument);for(var key in filter)if(key.toLowerCase()===String(argument._name).toLowerCase()||"all"===key.toLowerCase()){filter=filter[key](argument[0],argument[1],argument[2]);break}if(!filter)return}var readyMode=parent instanceof Items;return foo&&(argument.empty||(db.config.typeSensitive||argument[0],("string"!=typeof argument[0]&&"number"!=typeof argument[0]||"number"==typeof argument[0]&&argument[0]!=argument[0])&&(argument[0]=String(argument[0]))),foo.readyMode=readyMode,exec=foo(db.config.typeSensitive?parsekey(argument[0]):argument[0],argument[1],argument[2]),argument[1]&&"object"==typeof argument[1]&&argument[1]),promise=promise||new Promise((function(e){db.Syncdata.push({readyMode:readyMode,name:argument[0],value:argument[1],type:argument._name,r:e,exec:parseString(exec)})})),readyMode?("string"==typeof exec&&exec.eval&&(exec=eval(String(exec))),exec):promise},push=function(val,c){var name=val.name,value=val.value;"string"==typeof val.exec&&val.exec.eval&&(val.exec=eval(String(val.exec))),val.send=function(e){val.r(e)},db.config.cache?((val.type.includes("get")||val.type.includes("key"))&&val.readyMode||db.items[val.type](name,value),val.send(val.exec)):db.items[val.type](name,value).then(val.send)},then=function(e){e=attr.Row.init(e),db.SyncResolving>1||(db.SyncResolving+=1,db.items=e,db.config.cache?e.getAllItem((function(e,t){db.config.typeSensitive&&(e=parsekey(e)),"number"==typeof e?db.data.__proto__[e]=t:db.data[e]=t,db.keys.push(e)})).then((function(){push.resolve()})):push.resolve())},parseString=function(e,t){return t=t||";","string"!=typeof e||e.eval||(e=e.substring(e.lastIndexOf(t)+1)),e};push.resolve=function(){for(var e=0;db.Syncdata.length>e;e++)push(db.Syncdata[e]);db.Syncdata=[],db.config.cache&&(db.SyncResolved||db.SyncResolver(nonPromise)),foo(nonPromise),db.Syncdata=[],db.Syncdata.push=push,db.SyncResolved=!0},obj.setItem=function(){var e="setItem";return arguments._name=e,p(null,null,this,arguments,(function(e,t,n){return db.config.cache&&((!db.data.hasOwnProperty(e)&&"string"==typeof e||!db.data.__proto__.hasOwnProperty(e)&&"number"==typeof e||!0===n)&&db.keys.push(e),n||("number"==typeof e?db.data.__proto__[e]=t:db.data[e]=t)),done}))},obj.getItem=function(){var e="getItem";return arguments._name=e,p(null,null,this,arguments,(function(e){return db.data.__proto__.hasOwnProperty(e)&&"number"==typeof e?db.data.__proto__[e]:db.data.hasOwnProperty(e)?db.data[e]:void 0}))},obj.removeItem=function(){var e="removeItem";return arguments._name=e,p(null,null,this,arguments,(function(e){return db.config.cache&&(db.data.__proto__.hasOwnProperty(e)&&"number"==typeof e?delete db.data.__proto__[e]:db.data.hasOwnProperty(e)&&delete db.data[e],db.keys=Object.keys(db.data).concat(Object.keys(db.data.__proto__))),done}))},obj.clear=function(){var e="clear";return arguments._name=e,arguments.empty=!0,p(null,null,this,arguments,(function(){if(db.config.cache){for(var e=0;e<db.keys.length;e++)db.data.__proto__.hasOwnProperty(db.keys[e])&&"number"==typeof db.keys[e]?delete db.data.__proto__[db.keys[e]]:db.data.hasOwnProperty(db.keys[e])&&delete db.data[db.keys[e]];db.keys=Object.keys(db.data).concat(Object.keys(db.data.__proto__))}return done}))},obj.getAllItem=function(){var e="getAllItem";arguments._name=e,arguments.empty=!0;var t=arguments[0];return p(null,null,this,arguments,(function(){if("function"==typeof t&&arguments.callee.readyMode)try{for(var e in db.data)db.data.hasOwnProperty(e)?(db.config.typeSensitive&&(e=parsekey.decode(e)),t(e,db.data[e])):db.data.__proto__.hasOwnProperty(e)&&(db.config.typeSensitive&&(e=parsekey.decode(e)),t(e,db.data.__proto__[e]))}catch(e){_console.error(e)}return db.data}))},obj.key=function(){var e="key";return arguments._name=e,p(null,null,this,arguments,(function(e){if("number"==typeof Number(e))return db.keys[e]}))},obj.keys=function(){var e="keys";return arguments._name=e,arguments.empty=!0,p(null,null,this,arguments,(function(){return db.keys}))},obj.has=function(){var e="has";return arguments._name=e,p(null,null,this,arguments,(function(e){return"number"==typeof e?db.data.__proto__.hasOwnProperty(e):db.data.hasOwnProperty(e)}))},obj.__proto__={ready:new Promise((function(e){db.SyncResolver=e})),decodeKey:parsekey.decode,on:function(e,t){e=String(e).toLowerCase(),t instanceof Function&&"function"==typeof t&&(db.Events[e]?db.Events[e][db.Events[e].length]=t:db.Events[e]=[t])},length:function(){var e="length";return arguments._name=e,arguments.empty=!0,p(null,null,this,arguments,(function(){return db.keys.length}))},__proto__:{name:id,__proto__:new METHODS}};var observer={add:function(e,t){obj.setItem(e,t,!0)},delete:obj.removeItem};observer.update=obj.setItem;var nonPromise=new Items;return nonPromise.__proto__.__proto__=obj,db.SyncResolving>0&&config.settled&&_console.error(`${JSON.stringify(config)}\n-Above Object will be overwritten, for the returned values are instance of the previous initialized values for "${id}"`),db.items?push.resolve():db.SyncResolving<1&&(arguments.callee.stable(id,db,then,GCollector),db.SyncResolving+=1,db.Events=db.Events||{}),obj},this[NIMO_DB_ID.SYNC_KEY].__proto__={},this[NIMO_DB_ID.SYNC_KEY].__proto__.stable=function(e,t,n,o){o.SynchronizedTable?attr.Table.init(o.SynchronizedTable).openTable(e).then((function(t){t?n(t):attr.Table.init(o.SynchronizedTable).createTable(e).then(n)})):_this.forceOpenCreatedDatabase(SynNAME).then((function(t){t?(o.__proto__.SynchronizedTable=o.__proto__.SynchronizedTable||t,o.SynchronizedTable.openTable(e).then((function(t){t?n(t):o.SynchronizedTable.createTable(e).then((function(e){n(e)}))}))):_this.createDatabase(SynNAME).then((function(t){o.__proto__.SynchronizedTable=o.__proto__.SynchronizedTable||t,o.__proto__.SynchronizedTable.createTable(e).then((function(t){t?n(t):o.__proto__.SynchronizedTable.openTable(e).then(n)}))}))}))},this[NIMO_DB_ID.SYNC_KEY].__proto__.unstable=function(e,t,n,o){function r(t,n,o,a){if(n+=1,o.contains(e)){if(a)return a=(a=a.transaction(e,"readwrite")).objectStore(e),void new r.init(a);attr.indexedDB.open(SynNAME).onsuccess=function(t){t=(t=(t=t.target.result).transaction(e,"readwrite")).objectStore(e),new r.init(t)}}else attr.indexedDB.open(SynNAME,n).onupgradeneeded=function(e,t){e=e.target.result;for(var n=0;NIMO_DB_ID.STORE_MODE.length>n;n++)n+1===NIMO_DB_ID.STORE_MODE.length?e=e.createObjectStore(NIMO_DB_ID.STORE_MODE[n],{keyPath:keyPath}):(close(e.createObjectStore(NIMO_DB_ID.STORE_MODE[n],{keyPath:keyPath}),!0),t&&t());new r.init(e)}}r.init=function(t){if(t.transaction.db){var o=t;t={transaction:function(){return{objectStore:function(){return o}}}}}t.close=new Function,n(new attr.Row(t,e,attr))},attr.indexedDB.open(SynNAME).onsuccess=function(e){e=e.target.result,attr.version=e.version,e.version<=1?attr.indexedDB.open(_name).onsuccess=function(t){(t=(t=t.target.result).transaction(def,"readwrite")).oncomplete=function(){e.close(),r(e.name,e.version,e.objectStoreNames)};var n={};n[keyPath]=SynNAME,n.value={name:SynNAME,info:NIMO_DB_ID.time()},t.objectStore(def).add(n).onsuccess=function(){try{t.db.close()}catch(e){e.db.transaction.db.close()}}}:r(e.name,e.version,e.objectStoreNames,e)}},this[NIMO_DB_ID.SYNC_KEY].STORE_MODE=NIMO_DB_ID.STORE_MODE,this.createDatabase=function(){var e=arguments[0],t=new Promise((function(t){new NIMO_DB_ID(e).get().then((function(n){n?(_console.error(`can not create database:\n "${e}" already exist`),t(null)):attr.indexedDB.open(e).onsuccess=function(e){e.target.result.close(),t(new attr.Table(e.target.result))}}))}));return t},this.openCreatedDatabase=function(){var e=arguments[0],t=new Promise((function(t){new NIMO_DB_ID(e).get().then((function(n){n?attr.indexedDB.open(e).onsuccess=function(e){e.target.result.close(),t(new attr.Table(e.target.result))}:(_console.error(`"${e}" can not be open for it does not exist`),t(null))}))}));return t},this.forceOpenCreatedDatabase=function(){var e=arguments[0],t=new Promise((function(t){attr.indexedDB.open(e).onsuccess=function(e){e.target.result.close(),t(new attr.Table(e.target.result))}}));return t},this.getAllCreatedDatabase=function(){return new Promise((function(e){(new NIMO_DB_ID).getAll().then(e)}))},this.deleteAllCreatedDatabase=function(){return new Promise((function(e){(new NIMO_DB_ID).getAll().then((function(t){var n=[];for(var o in t){var r=syncResolver();n.push(r.promise),_this.deleteCreatedDatabase(o).then(r.r)}syncResolver.array(n).then(e)}))}))},this.deleteCreatedDatabase=function(){var e=arguments[0],t=new Promise((function(t){attr.indexedDB.deleteDatabase(e).onsuccess=function(n){new NIMO_DB_ID(e).remove().then(t)}}));return t},this.open=function(e,t){return e=e,t=t,new Promise((function(n){_this.openCreatedDatabase(e).then((function(e){e?e.openTable(t).then(n):n(e)}))}))},this.create=function(e,t){return e=e,t=t,new Promise((function(n){_this.createDatabase(e).then((function(e){e?e.createTable(t).then(n):n(e)}))}))},this.forceOpen=function(e,t){return new Promise((function(n){var o={keyPath:keyPath};attr.indexedDB.open(e).onsuccess=function(r){(r=r.target.result).objectStoreNames.contains(t)?(r.close(),n(new attr.Row(r,t,attr))):(r.close(),attr.indexedDB.open(e,r.version+1).onupgradeneeded=function(e){e=e.target.result,close(e.createObjectStore(t,o),!0),e.close(),n(new attr.Row(e,t,attr))})}}))},attr.Table=function(){var e=arguments[0];if(!(e instanceof IDBDatabase))return _console.error('argument[0] should be an instance of "IDBDatabase"  - <Table>');e.close();var t=e.version,n=e.objectStoreNames;e=e.realname||e.name,this.createTable=function(o,r){var a={keyPath:keyPath};return new Promise((function(r){n.contains(o),t+=1,attr.indexedDB.open(e,t).onupgradeneeded=function(e,t){if((e=e.target.result).objectStoreNames.contains(o))return _console.error(`A table with the name "${o}" already exist. `),r(null),void e.close();close(e.createObjectStore(o,a),!0),t&&t(),e.close(),r(new attr.Row(e,o,attr))}}))},this.openTable=function(t){return new Promise((function(o){n.contains(t),attr.indexedDB.open(e).onsuccess=function(e){if(!(e=e.target.result).objectStoreNames.contains(t))return _console.error(`A table with the name "${t}" does not exist. `),e.close(),void o(null);e.close(),o(new attr.Row(e,t,attr))}}))},this.deleteTable=function(o){return new Promise((function(r){n.contains(o),t+=1,attr.indexedDB.open(e,t).onupgradeneeded=function(e,t){(e=e.target.result).objectStoreNames.contains(o)?(e.deleteObjectStore(o),e.close(),t&&t(),r("done")):(_console.error(`A table with the name "${o}" does not exist. `),r(null))}}))},this.getAllTable=function(){return new Promise((function(t){attr.indexedDB.open(e).onsuccess=function(e){(e=e.target.result).close(),e=e.objectStoreNames,t(e)}}))},this.deleteAllTable=function(){return new Promise((function(n){t+=1,attr.indexedDB.open(e,t).onupgradeneeded=function(e,t){for(var o=(e=e.target.result).objectStoreNames,r=0;r<o.length;r++)e.deleteObjectStore(o[r]);e.close(),t&&t(),n("done")}}))}},attr.Row=function(){var e=arguments[0],t=arguments[1],n=this;if(!(e instanceof IDBDatabase))return _console.error('argument[0] should be an instance of "IDBDatabase"  - <Row>');t||_console.error("incorrect table name - <Row>");var o=NIMO_DB_ID.short(e);o.cloned||e.close(),e=e.realname||e.name;var r=setEnv(e,t),a=r.DB;this.setItem=function(r,a){var s=arguments,i=new Promise((function(i){o.indexedDB.open(e).onsuccess=function(e){var o={};o[keyPath]=r,o.value=a,e.target.result.transaction(t,"readwrite").objectStore(t).put(o).onsuccess=function(e){close(e),n.on.emit("setItem",s),i("done")}}}));return i},this.addItem=function(r,a){var s=arguments,i=new Promise((function(i){o.indexedDB.open(e).onsuccess=function(e){var o={};o[keyPath]=r,o.value=a,(e=e.target.result.transaction(t,"readwrite").objectStore(t).add(o)).onerror=function(e){close(e),i(null)},e.onsuccess=function(e){close(e),n.on.emit("addItem",s),i("done")}}}));return i},this.removeItem=function(){var r=arguments,a=arguments[0],s=new Promise((function(s){o.indexedDB.open(e).onsuccess=function(e){(e=e.target.result.transaction(t,"readwrite")).oncomplete=function(){},(e=e.objectStore(t)).delete(a).onsuccess=function(e){close(e),n.on.emit("removeItem",r),s("done")}}}));return s},this.clear=function(){var r=arguments,a=new Promise((function(a){o.indexedDB.open(e).onsuccess=function(e){(e=e.target.result.transaction(t,"readwrite")).oncomplete=function(){},(e=e.objectStore(t)).clear().onsuccess=function(e){close(e),n.on.emit("clear",r),a("done")}}}));return a},this.has=function(n){var r=new Promise((function(r){o.indexedDB.open(e).onsuccess=function(e){(e=(e=e.target.result.transaction(t,"readonly")).objectStore(t)).openCursor().onsuccess=function(e){var t=e.target.result;t?n===t.key?(close(e),r(!0)):t.continue():(close(e),r(!1))}}}));return r},this.getAllKeys=function(n){Number(arguments[0]);n="function"==typeof n?n:new Function;var r=new Promise((function(r){var a={},s=0;o.indexedDB.open(e).onsuccess=function(e){e.target.result.transaction(t,"readonly").objectStore(t).openKeyCursor().onsuccess=function(e){var t=e.target.result;t?(a[t.key]=s,n(t.key),s+=1,t.continue()):(close(e),r(a))}}}));return r},this.getKey=function(n){Number(arguments[0]);foo="function"==typeof foo?foo:new Function;var r=new Promise((function(r){var a=0;o.indexedDB.open(e).onsuccess=function(e){e.target.result.transaction(t,"readonly").objectStore(t).openKeyCursor().onsuccess=function(e){var t=e.target.result;t?n===t.key?(r(a),close(e)):(a+=1,t.continue()):(close(e),r(void 0))}}}));return r},this.key=function(){var n=Number(arguments[0]),r=new Promise((function(r){o.indexedDB.open(e).onsuccess=function(e){e.target.result.transaction(t,"readonly").objectStore(t).getAllKeys().onsuccess=function(e){close(e),r(e.target.result[n])}}}));return r},this.keys=function(){var n=arguments[0];n="function"==typeof n?n:new Function;var r=new Promise((function(n){o.indexedDB.open(e).onsuccess=function(e){e.target.result.transaction(t,"readonly").objectStore(t).getAllKeys().onsuccess=function(e){close(e),n(e.target.result)}}}));return r},this.length=function(){var n=arguments[0];n="function"==typeof n?n:new Function;var r=new Promise((function(n){o.indexedDB.open(e).onsuccess=function(e){e.target.result.transaction(t,"readonly").objectStore(t).count().onsuccess=function(e){close(e),n(e.target.result)}}}));return r},this.getAllItemAsArray=function(r){var a=arguments;r="function"==typeof(r=arguments[0])?r:new Function;var s=new Promise((function(r){o.indexedDB.open(e).onsuccess=function(e){e.target.result.transaction(t,"readonly").objectStore(t).getAll().onsuccess=function(e){close(e),n.on.emit("getAllItemAsArray",a),r(e.target.result)}}}));return s},this.getAllItem=function(r){var a=arguments;r="function"==typeof r?r:new Function;var s=new Promise((function(s){o.indexedDB.open(e).onsuccess=function(e){var o={__proto__:{}};e.target.result.transaction(t,"readonly").objectStore(t).openCursor().onsuccess=function(e){var t=e.target.result;if(t){var i=t.key;r(i,t.value.value),o.hasOwnProperty(i)?o.__proto__[i]=nimoOBJ(t.value):o[i]=nimoOBJ(t.value),t.continue()}else close(e),n.on.emit("getAllItem",a),s(o)}}}));return s},this.getItem=function(){var r=arguments,a=arguments[0],s=new Promise((function(s){o.indexedDB.open(e).onsuccess=function(e){e.target.result.transaction(t,"readonly").objectStore(t).get(a).onsuccess=function(e){close(e),e=nimoOBJ(e.target.result),n.on.emit("getItem",r),s(e)}}}));return s},this.on=function(e,t){e=String(e).toLowerCase(),t instanceof Function&&"function"==typeof t&&(a.Events[e]?a.Events[e][a.Events[e].length]=t:a.Events[e]=[t])},this.on.emit=function(e,t){if(t=t||[],e=String(e).toLowerCase(),a.Events[e]instanceof Array)for(var n=0;n<a.Events[e].length;n++)try{a.Events[e][n](t[0],t[1])}catch(e){}else a.Events[e]=[];if(a.Events.all)for(n=0;n<a.Events.all.length;n++)try{a.Events.all[n](e,t[0],t[1])}catch(e){}},a.Events||(a.Events={})},attr.Table.init=function(e){return e},attr.Row.init=function(e){return e},attr.DB=window.indexedDB,this.devMode=!0,attr.DB||(attr.DB={open:function(){return{}}}),attr.indexedDB={open:function(){var e=arguments.callee.queue,t=function(n){var o,r,a={};if(arguments[1]?a=arguments[1]:a.__proto__={error:null,onblocked:null,onerror:null,onsuccess:null,onupgradeneeded:null,readyState:"pending",result:null,source:null,transaction:null},e[0])return e[e.length-1].then((function(){e.pop(),t(n,a)})),a;((r=n[1]?attr.DB.open(toNimoName(n[0]),n[1]):attr.DB.open(toNimoName(n[0]))).ready=new Promise((function(e){o=function(t){"done"===t.readyState&&t.result&&(t.result.realname=n[0],a.__proto__.result=t.result),a.__proto__.readyState=t.readyState,e(t)}}))).then((function(e){"pending"===e.readyState||(a.__proto__.result=e.result),a.__proto__.readyState=e.readyState})),e.push(r.ready);var s=function(e){e.result.onerror=function(){e=arguments[0].target},o(e)};return r.onsuccess=function(e){o.success?delete o.success:s(e.target),a.onsuccess&&a.onsuccess(e)},r.onupgradeneeded=function(e){NIMO_DB_ID.row,new NIMO_DB_ID(n[0]).init([a.onupgradeneeded&&a.onupgradeneeded.nimo===_name]).then((function(){})),s(e.target),a.onupgradeneeded&&a.onupgradeneeded(e),o.success=!0},r.onerror=function(e){o(e.target),a.onerror&&a.onerror(e)},r.onblocked=function(e){o(e.target),a.onblocked&&a.onblocked(e)},a};return t(arguments)},deleteDatabase:function(){return attr.DB.deleteDatabase(toNimoName(arguments[0]),arguments[1])},databases:function(){return attr.DB.databases(arguments[0],arguments[1])},cmp:function(){return attr.DB.cmp(arguments[0],arguments[1])}},attr.indexedDB.open.queue=[],NIMO_DB_ID.store||(NIMO_DB_ID.store=attr.indexedDB.open(_name),(NIMO_DB_ID.store.onsuccess=function(e){NIMO_DB_ID.store.init||NIMO_DB_ID.push.resolve(e,def,attr)}).nimo=_name,(NIMO_DB_ID.store.onupgradeneeded=function(e,t){1===e.target.result.version&&(close(e.target.result.createObjectStore(def,{keyPath:keyPath}),!0),t&&t())}).nimo=_name);var _console={error:function(e){_this.devMode}}}var _console={error:function(e){}};NimoDB.__proto__={};var NIMO_DB_ID=function(e){var t=NIMO_DB_ID.set;this.init=function(){return"string"!=typeof e&&(e=arguments[0]),arguments[0]instanceof Array&&!0===arguments[0][0]?new Promise((function(e){e("done")})):new Promise((function(n,o){t.push(["addItem",[e,{name:toNimoName(e),info:NIMO_DB_ID.time()}],n])}))},this.get=function(){return"string"!=typeof e&&(e=arguments[0]),new Promise((function(n,o){"string"==typeof e?t.push(["getItem",[e],n]):_console.error(`invalid name type (${typeof e}), a valid String type was expected.`)}))},this.getAll=function(){return new Promise((function(e,n){t.push(["getAllItem",[],e])}))},this.clear=function(){return new Promise((function(e,n){t.push(["clear",[],e])}))},this.remove=function(){return"string"!=typeof e&&(e=arguments[0]),new Promise((function(n,o){"string"==typeof e?t.push(["removeItem",[e],n]):_console.error(`invalid name type (${typeof e}), a valid String type was expected.`)}))}};NIMO_DB_ID.push=function(e){NIMO_DB_ID.row[e[0]](e[1][0],e[1][1],e[1][2]).then(e[2])},NIMO_DB_ID.push.resolve=function(e,t,n){n=n||NimoDB.database,NIMO_DB_ID.store.init=!0,e.target.result.ice={},NIMO_DB_ID.row=NIMO_DB_ID.row||new n.Row(e.target.result,t,n);for(var o=0;NIMO_DB_ID.set.length>o;o++)NIMO_DB_ID.push(NIMO_DB_ID.set[o]);NIMO_DB_ID.set=[],NIMO_DB_ID.set.push=NIMO_DB_ID.push},NIMO_DB_ID.short=function(e,t){var n;return e instanceof IDBDatabase&&e.ice instanceof Object&&((n={indexedDB:{},cloned:!0,name:e.realname||e.name}).indexedDB.open=function(){var t={};return new Promise((function(e){e()})).then((function(){t.onsuccess({target:{result:e}})})),t}),n||NimoDB.__proto__.database},NIMO_DB_ID.parseString=function(e){var t=(e=String(e)).indexOf(":");return[e.substring(0,t),e.substring(t+1,e.length)]},NIMO_DB_ID.decode=function(e,t){return t||(e=NIMO_DB_ID.parseString(e)),e=e[1],e=(e=atob(e)).substring(0,e.length-NIMO_DB_ID.tmp.length)},NIMO_DB_ID.time=function(){var e={};return e.date=[(new Date).toDateString(),(new Date).toLocaleDateString()],e.exactDate=Date.now(),e},Object.observe=Object.observe||function(e,t){},Object.assign=Object.assign||function(e,t){return t.__proto__=e,t};var parsekey=function(e){return e="number"==typeof e||e instanceof Number?`Number:${Number(e)}`:`String:${String(e)}`};parsekey.decode=function(e){var t=(e=String(e)).substring(0,e.indexOf(":"));return t=(t=t.charAt(0).toUpperCase()+t.substring(1)).trim()||"String",e=e.substring(e.indexOf(":")+1),t in window==!1&&(t="String"),e=window[t](e)};var close=function(e,t){e instanceof Event&&(e=e.target),e.transaction.commit&&e.transaction.commit(),t||"object"==typeof e.transaction.db.ice||e.transaction.db.close()},encode=function(e,t){return t||(e=NIMO_DB_ID.parseString(e)),e=e[1],e=btoa(e)},nimoOBJ=function(e){return"object"==typeof e&&(e=e.value),e},toNimoName=function(e,t){t||e||_console.error("invalid name");var n=e+tmp;return n="NIMO:"+encode(n)},setEnv=function(e,t){return NimoDB.database.databases.Items[e]=NimoDB.database.databases.Items[e]||{},NimoDB.database.databases.Items[e].items=NimoDB.database.databases.Items[e].items||{},NimoDB.database.databases.Items[e].GCollectors=NimoDB.database.databases.Items[e].GCollectors||{},NimoDB.database.databases.Items[e].items[t]=NimoDB.database.databases.Items[e].items[t]||{},NimoDB.database.databases.Items[e].GCollectors.__proto__={},NimoDB.database.databases.Items[e].items[t].__proto__={},{GC:NimoDB.database.databases.Items[e].GCollectors,DB:NimoDB.database.databases.Items[e].items[t]}},syncResolver=function(e,t){return t=new Promise((function(t){e=t})),{r:e,promise:t}},Items=function(){arguments[0]&&(this.__proto__=new NUMBERS)},NUMBERS=function(){arguments[0]&&(this.__proto__.__proto__=new METHODS)},METHODS=function(){};syncResolver.array=function(e){var t=0;const n=syncResolver();function o(e,o){1,o.then((function(o){(t+=1)===e&&n.r(o)}))}for(var r=0;e.length>r;r++)o(e.length,e[r]);return 1>e.length&&n.r([]),n.promise};var has=function(e,t){return t in e};NIMO_DB_ID.set=[],NIMO_DB_ID.tmp="[hyper database 2003]",NIMO_DB_ID.keyPath="NIMO_DB_ID",NIMO_DB_ID.SYNC_KEY="Sync",NIMO_DB_ID.STORE_MODE=[new String("Sync storage"),new String("Sync storage(2)")],NimoDB.__proto__.database={__proto__:{databases:{Items:{},GCollectors:{}}}};var attr=NimoDB.__proto__.database,SynID=String(NIMO_DB_ID.STORE_MODE[0]),done="done",SynNAME=location.origin,keyPath=NIMO_DB_ID.keyPath,def="records",_name=keyPath,tmp=NIMO_DB_ID.tmp;NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY]=new NimoDB,NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY].devMode=!1,NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY]=NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY][NIMO_DB_ID.SYNC_KEY](NIMO_DB_ID.STORE_MODE[0],{cache:!0,typeSensitive:!1,filter:function(e){e[0]=String(e[0]),this.setItem=function(e,t){return!(t instanceof Blob||t instanceof File)||(_console.error("Blob and File type are not supported on sync mode, please convert them to buffers and try again"),!1)}}}),window.NimoDB=NimoDB})();