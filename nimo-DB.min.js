!function(){function NimoDB(){if(this instanceof NimoDB==!1)return new NimoDB;var _this=this;this[NIMO_DB_ID.SYNC_KEY]=function(){for(var id,foo=new Function,config={cache:!0,typeSensitive:!0,accept:["array","object","number","string"]},i=0;arguments.length>i;i++){var ty=arguments[i]?typeof arguments[i]:null;"string"===ty||arguments[i]instanceof String?id=arguments[i]:"object"===ty?(arguments[i].__proto__=config,config=arguments[i],config.settled=!0):"function"===ty&&(foo=arguments[i])}id===SynID&&_console.error(`"${id}" is already taken for our prototype`),("string"!=typeof id&&id instanceof String==!1||!id.trim())&&(id=SynID),id=id.trim();var Env=setEnv(SynNAME,id),GCollector=Env.GC,db=Env.DB;if(db.obj)return db.obj;db.obj=new METHODS,db.Syncdata=db.Syncdata||[],db.config=db.config||config,db.data=db.data||new Items(!0),db.keys=db.keys||[],db.dataAsArray=db.dataAsArray||[],db.SyncResolving=db.SyncResolving||0,db.opening=db.opening||0,"cache"in db.config==!1&&(db.config.cache=!0);var obj=db.obj,p=function(exec,promise,parent,argument,foo){if(db.config.filter&&db.config.filter instanceof Function&&"function"==typeof db.config.filter){var filter=new db.config.filter(argument);for(var key in filter)if(key.toLowerCase()===String(argument._name).toLowerCase()||"all"===key.toLowerCase()){filter=filter[key](argument[0],argument[1],argument[2]);break}if(!filter)return}var readyMode=parent instanceof Items;return foo&&(argument.empty||(db.config.typeSensitive||argument[0],("string"!=typeof argument[0]&&"number"!=typeof argument[0]||"number"==typeof argument[0]&&argument[0]!=argument[0])&&(argument[0]=String(argument[0]))),foo.readyMode=readyMode,exec=foo(db.config.typeSensitive?parsekey(argument[0]):argument[0],argument[1],argument[2]),argument[1]&&"object"==typeof argument[1]&&argument[1]),promise=promise||new Promise((function(r){db.Syncdata.push({readyMode:readyMode,name:argument[0],value:argument[1],type:argument._name,r:r,exec:parseString(exec)})})),readyMode?("string"==typeof exec&&exec.eval&&(exec=eval(String(exec))),exec):promise},push=function(val,c){var name=val.name,value=val.value;"string"==typeof val.exec&&val.exec.eval&&(val.exec=eval(String(val.exec))),val.send=function(e){val.r(e)},db.config.cache?((val.type.includes("get")||val.type.includes("key"))&&val.readyMode||db.items[val.type](name,value),val.send(val.exec)):db.items[val.type](name,value).then(val.send)},then=function(e){e=attr.Row.init(e),db.SyncResolving>1||(db.SyncResolving+=1,db.items=e,db.config.cache?e.getAllItem((function(key,value){db.config.typeSensitive&&(key=parsekey(key)),"number"==typeof key?db.data.__proto__[key]=value:db.data[key]=value,db.keys.push(key)})).then((function(){push.resolve()})):push.resolve())},parseString=function(e,v){return v=v||";","string"!=typeof e||e.eval||(e=e.substring(e.lastIndexOf(v)+1)),e};push.resolve=function(){for(var i=0;db.Syncdata.length>i;i++)push(db.Syncdata[i]);db.Syncdata=[],db.config.cache&&(db.SyncResolved||db.SyncResolver(nonPromise)),foo(nonPromise),db.Syncdata=[],db.Syncdata.push=push,db.SyncResolved=!0},obj.setItem=function(){var type="setItem";return arguments._name=type,p(null,null,this,arguments,(function(name,value,s){return db.config.cache&&((!db.data.hasOwnProperty(name)&&"string"==typeof name||!db.data.__proto__.hasOwnProperty(name)&&"number"==typeof name||!0===s)&&db.keys.push(name),s||("number"==typeof name?db.data.__proto__[name]=value:db.data[name]=value)),done}))},obj.getItem=function(){var type="getItem";return arguments._name=type,p(null,null,this,arguments,(function(name){return db.data.__proto__.hasOwnProperty(name)&&"number"==typeof name?db.data.__proto__[name]:db.data.hasOwnProperty(name)?db.data[name]:void 0}))},obj.removeItem=function(){var type="removeItem";return arguments._name=type,p(null,null,this,arguments,(function(name){return db.config.cache&&(db.data.__proto__.hasOwnProperty(name)&&"number"==typeof name?delete db.data.__proto__[name]:db.data.hasOwnProperty(name)&&delete db.data[name],db.keys=Object.keys(db.data).concat(Object.keys(db.data.__proto__))),done}))},obj.clear=function(){var type="clear";return arguments._name=type,arguments.empty=!0,p(null,null,this,arguments,(function(){if(db.config.cache){for(var i=0;i<db.keys.length;i++)db.data.__proto__.hasOwnProperty(db.keys[i])&&"number"==typeof db.keys[i]?delete db.data.__proto__[db.keys[i]]:db.data.hasOwnProperty(db.keys[i])&&delete db.data[db.keys[i]];db.keys=Object.keys(db.data).concat(Object.keys(db.data.__proto__))}return done}))},obj.getAllItem=function(){var type="getAllItem";arguments._name=type,arguments.empty=!0;var foo=arguments[0];return p(null,null,this,arguments,(function(){if("function"==typeof foo&&arguments.callee.readyMode)try{for(var key in db.data)db.data.hasOwnProperty(key)?(db.config.typeSensitive&&(key=parsekey.decode(key)),foo(key,db.data[key])):db.data.__proto__.hasOwnProperty(key)&&(db.config.typeSensitive&&(key=parsekey.decode(key)),foo(key,db.data.__proto__[key]))}catch(e){_console.error(e)}return db.data}))},obj.key=function(){var type="key";return arguments._name=type,p(null,null,this,arguments,(function(index){if("number"==typeof Number(index))return db.keys[index]}))},obj.keys=function(){var type="keys";return arguments._name=type,arguments.empty=!0,p(null,null,this,arguments,(function(){return db.keys}))},obj.has=function(){var type="has";return arguments._name=type,p(null,null,this,arguments,(function(name){return"number"==typeof name?db.data.__proto__.hasOwnProperty(name):db.data.hasOwnProperty(name)}))},obj.__proto__={ready:new Promise((function(r){db.SyncResolver=r})),decodeKey:parsekey.decode,on:function(name,foo){name=String(name).toLowerCase(),foo instanceof Function&&"function"==typeof foo&&(db.Events[name]?db.Events[name][db.Events[name].length]=foo:db.Events[name]=[foo])},length:function(){var type="length";return arguments._name=type,arguments.empty=!0,p(null,null,this,arguments,(function(){return db.keys.length}))},__proto__:{name:id,__proto__:new METHODS}};var observer={add:function(name,value){obj.setItem(name,value,!0)},delete:obj.removeItem};observer.update=obj.setItem;var nonPromise=new Items;return nonPromise.__proto__.__proto__=obj,db.SyncResolving>0&&config.settled&&_console.error(`${JSON.stringify(config)}\n-Above Object will be overwritten, for the returned values are instance of the previous initialized values for "${id}"`),db.items?push.resolve():db.SyncResolving<1&&(arguments.callee.stable(id,db,then,GCollector),db.SyncResolving+=1,db.Events=db.Events||{}),obj},this[NIMO_DB_ID.SYNC_KEY].__proto__={},this[NIMO_DB_ID.SYNC_KEY].__proto__.stable=function(id,db,then,GCollector){GCollector.SynchronizedTable?attr.Table.init(GCollector.SynchronizedTable).openTable(id).then((function(e){e?then(e):attr.Table.init(GCollector.SynchronizedTable).createTable(id).then(then)})):_this.forceOpenCreatedDatabase(SynNAME).then((function(e){e?(GCollector.__proto__.SynchronizedTable=GCollector.__proto__.SynchronizedTable||e,GCollector.SynchronizedTable.openTable(id).then((function(e){e?then(e):GCollector.SynchronizedTable.createTable(id).then((function(e){then(e)}))}))):_this.createDatabase(SynNAME).then((function(e){GCollector.__proto__.SynchronizedTable=GCollector.__proto__.SynchronizedTable||e,GCollector.__proto__.SynchronizedTable.createTable(id).then((function(_e){_e?then(_e):GCollector.__proto__.SynchronizedTable.openTable(id).then(then)}))}))}))},this[NIMO_DB_ID.SYNC_KEY].__proto__.unstable=function(id,db,then,GCollector){function frh(name,version,tables,e){if(version+=1,tables.contains(id)){if(e)return e=(e=e.transaction(id,"readwrite")).objectStore(id),void new frh.init(e);attr.indexedDB.open(SynNAME).onsuccess=function(e){e=(e=(e=e.target.result).transaction(id,"readwrite")).objectStore(id),new frh.init(e)}}else attr.indexedDB.open(SynNAME,version).onupgradeneeded=function(e,_r){e=e.target.result;for(var i=0;NIMO_DB_ID.STORE_MODE.length>i;i++)i+1===NIMO_DB_ID.STORE_MODE.length?e=e.createObjectStore(NIMO_DB_ID.STORE_MODE[i],{keyPath:keyPath}):(close(e.createObjectStore(NIMO_DB_ID.STORE_MODE[i],{keyPath:keyPath}),!0),_r&&_r());new frh.init(e)}}frh.init=function(e){if(e.transaction.db){var _e=e;e={transaction:function(){return{objectStore:function(){return _e}}}}}e.close=new Function,then(new attr.Row(e,id,attr))},attr.indexedDB.open(SynNAME).onsuccess=function(_e){_e=_e.target.result,attr.version=_e.version,_e.version<=1?attr.indexedDB.open(_name).onsuccess=function(e){(e=(e=e.target.result).transaction(def,"readwrite")).oncomplete=function(){_e.close(),frh(_e.name,_e.version,_e.objectStoreNames)};var obj={};obj[keyPath]=SynNAME,obj.value={name:SynNAME,info:NIMO_DB_ID.time()},e.objectStore(def).add(obj).onsuccess=function(){try{e.db.close()}catch(e){e.db.transaction.db.close()}}}:frh(_e.name,_e.version,_e.objectStoreNames,_e)}},this[NIMO_DB_ID.SYNC_KEY].STORE_MODE=NIMO_DB_ID.STORE_MODE,this.createDatabase=function(){var name=arguments[0],f=null,rst=new Promise((function(r){new NIMO_DB_ID(name).get().then((function(exist){exist?(_console.error(`can not create database:\n "${name}" already exist`),r(null)):attr.indexedDB.open(name).onsuccess=function(e){e.target.result.close(),r(new attr.Table(e.target.result))}}))}));return rst},this.openCreatedDatabase=function(){var name=arguments[0],$t=arguments[2],rst=new Promise((function(r){new NIMO_DB_ID(name).get().then((function(has){has?attr.indexedDB.open(name).onsuccess=function(e){e.target.result.close(),r(new attr.Table(e.target.result))}:(_console.error(`"${name}" can not be open for it does not exist`),r(null))}))}));return rst},this.forceOpenCreatedDatabase=function(){var name=arguments[0],$t=arguments[2],rst=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){e.target.result.close(),r(new attr.Table(e.target.result))}}));return rst},this.getAllCreatedDatabase=function(){var prm;return new Promise((function(r){(new NIMO_DB_ID).getAll().then(r)}))},this.deleteAllCreatedDatabase=function(){return new Promise((function(r){(new NIMO_DB_ID).getAll().then((function(e){var arr=[];for(var prop in e){var syn=syncResolver();arr.push(syn.promise),_this.deleteCreatedDatabase(prop).then(syn.r)}syncResolver.array(arr).then(r)}))}))},this.deleteCreatedDatabase=function(){var name=arguments[0],prm=new Promise((function(r){attr.indexedDB.deleteDatabase(name).onsuccess=function(e){new NIMO_DB_ID(name).remove().then(r)}}));return prm},this.open=function(db,tb){return db=db,tb=tb,new Promise((function(r){_this.openCreatedDatabase(db).then((function(e){e?e.openTable(tb).then(r):r(e)}))}))},this.create=function(db,tb){return db=db,tb=tb,new Promise((function(r){_this.createDatabase(db).then((function(e){e?e.createTable(tb).then(r):r(e)}))}))},attr.Table=function(){var name=arguments[0];if(!(name instanceof IDBDatabase))return _console.error('argument[0] should be an instance of "IDBDatabase"  - <Table>');name.close();var vs=name.version,tb=name.objectStoreNames;name=name.realname||name.name,this.createTable=function(tb_name,tb_config){var obj={keyPath:keyPath};return new Promise((function(r){tb.contains(tb_name),vs+=1,attr.indexedDB.open(name,vs).onupgradeneeded=function(e,_r){if((e=e.target.result).objectStoreNames.contains(tb_name))return _console.error(`A table with the name "${tb_name}" already exist. `),r(null),void e.close();close(e.createObjectStore(tb_name,obj),!0),_r&&_r(),e.close(),r(new attr.Row(e,tb_name,attr))}}))},this.openTable=function(tb_name){return new Promise((function(r){tb.contains(tb_name),attr.indexedDB.open(name).onsuccess=function(e){if(!(e=e.target.result).objectStoreNames.contains(tb_name))return _console.error(`A table with the name "${tb_name}" does not exist. `),e.close(),void r(null);e.close(),r(new attr.Row(e,tb_name,attr))}}))},this.deleteTable=function(tb_name){return new Promise((function(r){tb.contains(tb_name),vs+=1,attr.indexedDB.open(name,vs).onupgradeneeded=function(e,_r){(e=e.target.result).objectStoreNames.contains(tb_name)?(e.deleteObjectStore(tb_name),e.close(),_r&&_r(),r("done")):(_console.error(`A table with the name "${tb_name}" does not exist. `),r(null))}}))},this.getAllTable=function(){return new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){(e=e.target.result).close(),e=e.objectStoreNames,r(e)}}))},this.deleteAllTable=function(){return new Promise((function(r){vs+=1,attr.indexedDB.open(name,vs).onupgradeneeded=function(e,_r){for(var objN=(e=e.target.result).objectStoreNames,i=0;i<objN.length;i++)e.deleteObjectStore(objN[i]);e.close(),_r&&_r(),r("done")}}))}},attr.Row=function(){var name=arguments[0],tb_name=arguments[1],_this=this;if(!(name instanceof IDBDatabase))return _console.error('argument[0] should be an instance of "IDBDatabase"  - <Row>');tb_name||_console.error("incorrect table name - <Row>");var attr=NIMO_DB_ID.short(name);attr.cloned||name.close(),name=name.realname||name.name;var Env=setEnv(name,tb_name),db=Env.DB;this.setItem=function(key,value){var argument=arguments,prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){var obj={};obj[keyPath]=key,obj.value=value,e.target.result.transaction(tb_name,"readwrite").objectStore(tb_name).put(obj).onsuccess=function(e){close(e),_this.on.emit("setItem",argument),r("done")}}}));return prm},this.addItem=function(key,value){var argument=arguments,prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){var obj={};obj[keyPath]=key,obj.value=value,(e=e.target.result.transaction(tb_name,"readwrite").objectStore(tb_name).add(obj)).onerror=function(e){close(e),r(null)},e.onsuccess=function(e){close(e),_this.on.emit("addItem",argument),r("done")}}}));return prm},this.removeItem=function(){var argument=arguments,$name=arguments[0],prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){var $e,val;(e=e.target.result.transaction(tb_name,"readwrite")).oncomplete=function(){},(e=e.objectStore(tb_name)).delete($name).onsuccess=function(e){close(e),_this.on.emit("removeItem",argument),r("done")}}}));return prm},this.clear=function(){var argument=arguments,prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){var $e;(e=e.target.result.transaction(tb_name,"readwrite")).oncomplete=function(){},(e=e.objectStore(tb_name)).clear().onsuccess=function(e){close(e),_this.on.emit("clear",argument),r("done")}}}));return prm},this.has=function($val){var argument=arguments,prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){var $e,val;(e=(e=e.target.result.transaction(tb_name,"readonly")).objectStore(tb_name)).openCursor().onsuccess=function(e){var rst=e.target.result;rst?$val===rst.key?(close(e),r(!0)):rst.continue():(close(e),r(!1))}}}));return prm},this.key=function(){var argument=arguments,index=Number(arguments[0]),prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){e.target.result.transaction(tb_name,"readonly").objectStore(tb_name).getAllKeys().onsuccess=function(e){close(e),r(e.target.result[index])}}}));return prm},this.keys=function(){var argument=arguments,f=arguments[0];f="function"==typeof f?f:new Function;var prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){e.target.result.transaction(tb_name,"readonly").objectStore(tb_name).getAllKeys().onsuccess=function(e){close(e),r(e.target.result)}}}));return prm},this.length=function(){var argument=arguments,f=arguments[0];f="function"==typeof f?f:new Function;var prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){e.target.result.transaction(tb_name,"readonly").objectStore(tb_name).count().onsuccess=function(e){close(e),r(e.target.result)}}}));return prm},this.getAllItemAsArray=function(f){var argument=arguments,f;f="function"==typeof(f=arguments[0])?f:new Function;var prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){e.target.result.transaction(tb_name,"readonly").objectStore(tb_name).getAll().onsuccess=function(e){close(e),_this.on.emit("getAllItemAsArray",argument),r(e.target.result)}}}));return prm},this.getAllItem=function(f){var argument=arguments;f="function"==typeof f?f:new Function;var prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){var array={__proto__:{}};e.target.result.transaction(tb_name,"readonly").objectStore(tb_name).openCursor().onsuccess=function(e){var rst=e.target.result;if(rst){var key=rst.key;f(key,rst.value.value),array.hasOwnProperty(key)?array.__proto__[key]=nimoOBJ(rst.value):array[key]=nimoOBJ(rst.value),rst.continue()}else close(e),_this.on.emit("getAllItem",argument),r(array)}}}));return prm},this.getItem=function(){var argument=arguments,$name=arguments[0],prm=new Promise((function(r){attr.indexedDB.open(name).onsuccess=function(e){e.target.result.transaction(tb_name,"readonly").objectStore(tb_name).get($name).onsuccess=function(e){close(e),e=nimoOBJ(e.target.result),_this.on.emit("getItem",argument),r(e)}}}));return prm},this.on=function(name,foo){name=String(name).toLowerCase(),foo instanceof Function&&"function"==typeof foo&&(db.Events[name]?db.Events[name][db.Events[name].length]=foo:db.Events[name]=[foo])},this.on.emit=function(type,argument){if(argument=argument||[],type=String(type).toLowerCase(),db.Events[type]instanceof Array)for(var i=0;i<db.Events[type].length;i++)try{db.Events[type][i](argument[0],argument[1])}catch(error){}else db.Events[type]=[];if(db.Events.all)for(var i=0;i<db.Events.all.length;i++)try{db.Events.all[i](type,argument[0],argument[1])}catch(error){}},db.Events||(db.Events={})},attr.Table.init=function(e){return e},attr.Row.init=function(e){return e},attr.DB=window.indexedDB,this.devMode=!0,attr.DB||(attr.DB={open:function(){return{}}}),attr.indexedDB={open:function(){var qu=arguments.callee.queue,init=function(argument){var obj={},r,e;if(arguments[1]?obj=arguments[1]:obj.__proto__={error:null,onblocked:null,onerror:null,onsuccess:null,onupgradeneeded:null,readyState:"pending",result:null,source:null,transaction:null},qu[0])return qu[qu.length-1].then((function(){qu.pop(),init(argument,obj)})),obj;((e=argument[1]?attr.DB.open(toNimoName(argument[0]),argument[1]):attr.DB.open(toNimoName(argument[0]))).ready=new Promise((function(resolve){r=function(e){"done"===e.readyState&&e.result&&(e.result.realname=argument[0],obj.__proto__.result=e.result),obj.__proto__.readyState=e.readyState,resolve(e)}}))).then((function(e){"pending"===e.readyState||(obj.__proto__.result=e.result),obj.__proto__.readyState=e.readyState})),qu.push(e.ready);var foo=function(e){e.result.onerror=function(){e=arguments[0].target},r(e)};return e.onsuccess=function(e){r.success?delete r.success:foo(e.target),obj.onsuccess&&obj.onsuccess(e)},e.onupgradeneeded=function(e){NIMO_DB_ID.row,new NIMO_DB_ID(argument[0]).init([obj.onupgradeneeded&&obj.onupgradeneeded.nimo===_name]).then((function(){})),foo(e.target),obj.onupgradeneeded&&obj.onupgradeneeded(e),r.success=!0},e.onerror=function(e){r(e.target),obj.onerror&&obj.onerror(e)},e.onblocked=function(e){r(e.target),obj.onblocked&&obj.onblocked(e)},obj};return init(arguments)},deleteDatabase:function(){return attr.DB.deleteDatabase(toNimoName(arguments[0]),arguments[1])},databases:function(){return attr.DB.databases(arguments[0],arguments[1])},cmp:function(){return attr.DB.cmp(arguments[0],arguments[1])}},attr.indexedDB.open.queue=[],NIMO_DB_ID.store||(NIMO_DB_ID.store=attr.indexedDB.open(_name),(NIMO_DB_ID.store.onsuccess=function(e){NIMO_DB_ID.store.init||NIMO_DB_ID.push.resolve(e,def,attr)}).nimo=_name,(NIMO_DB_ID.store.onupgradeneeded=function(e,_r){1===e.target.result.version&&(close(e.target.result.createObjectStore(def,{keyPath:keyPath}),!0),_r&&_r())}).nimo=_name);var _console={error:function(x){_this.devMode&&console.error(x)}}}var _console={error:function(x){console.error(x)}};NimoDB.__proto__={};var NIMO_DB_ID=function(name){var arg=arguments,add=NIMO_DB_ID.set;this.init=function(){return"string"!=typeof name&&(name=arguments[0]),arguments[0]instanceof Array&&!0===arguments[0][0]?new Promise((function(r){r("done")})):new Promise((function(r,j){add.push(["addItem",[name,{name:toNimoName(name),info:NIMO_DB_ID.time()}],r])}))},this.get=function(){return"string"!=typeof name&&(name=arguments[0]),new Promise((function(r,j){"string"==typeof name?add.push(["getItem",[name],r]):_console.error(`invalid name type (${typeof name}), a valid String type was expected.`)}))},this.getAll=function(){return new Promise((function(r,j){add.push(["getAllItem",[],r])}))},this.clear=function(){return new Promise((function(r,j){add.push(["clear",[],r])}))},this.remove=function(){return"string"!=typeof name&&(name=arguments[0]),new Promise((function(r,j){"string"==typeof name?add.push(["removeItem",[name],r]):_console.error(`invalid name type (${typeof name}), a valid String type was expected.`)}))}};NIMO_DB_ID.push=function(e){NIMO_DB_ID.row[e[0]](e[1][0],e[1][1],e[1][2]).then(e[2])},NIMO_DB_ID.push.resolve=function(e,def,attr){attr=attr||NimoDB.database,NIMO_DB_ID.store.init=!0,e.target.result.ice={},NIMO_DB_ID.row=NIMO_DB_ID.row||new attr.Row(e.target.result,def,attr);for(var i=0;NIMO_DB_ID.set.length>i;i++)NIMO_DB_ID.push(NIMO_DB_ID.set[i]);NIMO_DB_ID.set=[],NIMO_DB_ID.set.push=NIMO_DB_ID.push},NIMO_DB_ID.short=function(name,o){var _attr;return name instanceof IDBDatabase&&name.ice instanceof Object&&((_attr={indexedDB:{},cloned:!0,name:name.realname||name.name}).indexedDB.open=function(){var obj={};return new Promise((function(r){r()})).then((function(){obj.onsuccess({target:{result:name}})})),obj}),_attr||NimoDB.__proto__.database},NIMO_DB_ID.parseString=function(x){var idx=(x=String(x)).indexOf(":"),sub_1,sub_2;return[x.substring(0,idx),x.substring(idx+1,x.length)]},NIMO_DB_ID.decode=function(x,y){return y||(x=NIMO_DB_ID.parseString(x)),x=x[1],x=(x=atob(x)).substring(0,x.length-NIMO_DB_ID.tmp.length)},NIMO_DB_ID.time=function(){var obj={};return obj.date=[(new Date).toDateString(),(new Date).toLocaleDateString()],obj.exactDate=Date.now(),obj},Object.observe=Object.observe||function(obj,f){},Object.assign=Object.assign||function(p,c){return c.__proto__=p,c};var parsekey=function(key){return key="number"==typeof key||key instanceof Number?`Number:${Number(key)}`:`String:${String(key)}`};parsekey.decode=function(key){var type=(key=String(key)).substring(0,key.indexOf(":"));return type=(type=type.charAt(0).toUpperCase()+type.substring(1)).trim()||"String",key=key.substring(key.indexOf(":")+1),type in window==!1&&(type="String"),key=window[type](key)};var close=function(e,d){e instanceof Event&&(e=e.target),e.transaction.commit&&e.transaction.commit(),d||"object"==typeof e.transaction.db.ice||e.transaction.db.close()},encode=function(x,y){return y||(x=NIMO_DB_ID.parseString(x)),x=x[1],x=btoa(x)},nimoOBJ=function(e){return"object"==typeof e&&(e=e.value),e},toNimoName=function(x,y){y||x||_console.error("invalid name");var name=x+tmp;return name="NIMO:"+encode(name)},setEnv=function(SynNAME,id){return NimoDB.database.databases.Items[SynNAME]=NimoDB.database.databases.Items[SynNAME]||{},NimoDB.database.databases.Items[SynNAME].items=NimoDB.database.databases.Items[SynNAME].items||{},NimoDB.database.databases.Items[SynNAME].GCollectors=NimoDB.database.databases.Items[SynNAME].GCollectors||{},NimoDB.database.databases.Items[SynNAME].items[id]=NimoDB.database.databases.Items[SynNAME].items[id]||{},NimoDB.database.databases.Items[SynNAME].GCollectors.__proto__={},NimoDB.database.databases.Items[SynNAME].items[id].__proto__={},{GC:NimoDB.database.databases.Items[SynNAME].GCollectors,DB:NimoDB.database.databases.Items[SynNAME].items[id]}},syncResolver=function(r,promise){return promise=new Promise((function(_r){r=_r})),{r:r,promise:promise}},Items=function(){arguments[0]&&(this.__proto__=new NUMBERS)},NUMBERS=function(){arguments[0]&&(this.__proto__.__proto__=new METHODS)},METHODS=function(){arguments[0]};syncResolver.array=function(ar){var d=0,d2=0;const syn=syncResolver();function f(l,ar){d2+=1,ar.then((function(e){(d+=1)===l&&syn.r(e)}))}for(var i=0;ar.length>i;i++)f(ar.length,ar[i]);return 1>ar.length&&syn.r([]),syn.promise};var has=function(e,name){return name in e};NIMO_DB_ID.set=[],NIMO_DB_ID.tmp="[hyper database 2003]",NIMO_DB_ID.keyPath="NIMO_DB_ID",NIMO_DB_ID.SYNC_KEY="Sync",NIMO_DB_ID.STORE_MODE=[new String("Sync storage"),new String("Sync storage(2)")],NimoDB.__proto__.database={__proto__:{databases:{Items:{},GCollectors:{}}}};var attr=NimoDB.__proto__.database,SynID=String(NIMO_DB_ID.STORE_MODE[0]),done="done",SynNAME=location.origin,keyPath=NIMO_DB_ID.keyPath,def="records",_name=keyPath,tmp=NIMO_DB_ID.tmp;NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY]=new NimoDB,NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY].devMode=!1,NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY]=NimoDB.__proto__[NIMO_DB_ID.SYNC_KEY][NIMO_DB_ID.SYNC_KEY](NIMO_DB_ID.STORE_MODE[0],{cache:!0,typeSensitive:!1,filter:function(argument){argument[0]=String(argument[0]),this.setItem=function(name,value){return!(value instanceof Blob||value instanceof File)||(_console.error("Blob and File type are not supported on sync mode, please convert them to buffers and try again"),!1)}}}),window.NimoDB=NimoDB}();